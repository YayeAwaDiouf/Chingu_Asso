{% extends "base.html" %}

{% block content %}

<h1 class="section-title">Dashboard — Vue d’ensemble</h1>
<p class="section-subtitle">
    Aperçu rapide des activités principales de l’association.
</p>

<!-- ==== CARDS STATISTIQUES ==== -->
<div style="display: flex; gap: 25px; flex-wrap: wrap;">

    <div class="card" style="flex: 1; min-width: 250px;">
        <span class="badge badge-blue">INFO</span>
        <h2 class="card-title">{{ members }} Membres actifs</h2>
        <p>Nombre total de membres inscrits et actifs dans l’association.</p>
    </div>

    <div class="card" style="flex: 1; min-width: 250px;">
        <span class="badge badge-green">STATS</span>
        <h2 class="card-title">{{ dues }} % de cotisations payées</h2>
        <p>Taux global de cotisations réglées pour l’année en cours.</p>
    </div>

    <div class="card" style="flex: 1; min-width: 250px;">
        <span class="badge badge-orange">ACTIONS</span>
        <h2 class="card-title">{{ events }} Événements à venir</h2>
        <p>Événements programmés et non encore passés.</p>
    </div>

</div>


<!-- ==== LISTE DES DERNIERS MEMBRES ==== -->
<h2 class="section-title" style="margin-top: 50px;">Derniers membres inscrits</h2>

<div class="card">
    <table>
        <tr>
            <th>Nom</th>
            <th>Email</th>
            <th>Inscription</th>
            <th>Cotisation</th>
        </tr>

        {% for m in last_members %}
        <tr>
            <td>{{ m.first_name }} {{ m.last_name }}</td>
            <td>{{ m.email }}</td>
            <td>{{ m.joined_on }}</td>
            <td>
                {% set latest_due = m.dues|last %}
                {% if latest_due %}
                    {% if latest_due.paid %}
                        ✔ Payée
                    {% else %}
                        ❌ Non payée
                    {% endif %}
                {% else %}
                    - Aucune
                {% endif %}
            </td>
        </tr>
        {% endfor %}
    </table>
</div>


{% endblock %}
