{% extends "base.html" %}

{% block content %}

<h1 class="section-title">Gestion des √©v√©nements</h1>
<p class="section-subtitle">Liste des √©v√©nements programm√©s dans l‚Äôassociation.</p>

<!-- Bouton Ajouter -->
<a href="{{ url_for('events_new') }}" class="btn-gold" style="margin-bottom: 25px; display: inline-block;">
    ‚ûï Ajouter un √©v√©nement
</a>

<div class="card">
    <table>
        <thead>
        <tr>
            <th>Titre</th>
            <th>Date</th>
            <th>Lieu</th>
            <th>Actions</th>
        </tr>
        </thead>

        <tbody>
        {% for e in events %}
        <tr>
            <td>{{ e.title }}</td>
            <td>{{ e.event_date }}</td>
            <td>{{ e.location or '-' }}</td>

            <td>
                <!-- Bouton Modifier -->
                <a href="{{ url_for('events_edit', event_id=e.id) }}" class="action-edit">‚úè Modifier</a>

                <!-- Bouton Supprimer -->
                <button class="action-delete"
                        data-url="{{ url_for('events_delete', event_id=e.id) }}">
                    üóë Supprimer
                </button>
            </td>
        </tr>
        {% else %}
        <tr><td colspan="4" class="text-center">Aucun √©v√©nement pour le moment.</td></tr>
        {% endfor %}
        </tbody>
    </table>
</div>

<!-- Script SweetAlert pour suppression -->
<script>
document.querySelectorAll(".action-delete").forEach(btn => {
    btn.addEventListener("click", function () {
        let url = this.getAttribute("data-url");
        Swal.fire({
            title: "Supprimer cet √©v√©nement ?",
            text: "Cette action est irr√©versible.",
            icon: "warning",
            showCancelButton: true,
            confirmButtonColor: "#0a0f2e",
            cancelButtonColor: "#B83227",
            confirmButtonText: "Oui, supprimer",
            cancelButtonText: "Annuler"
        }).then((result) => {
            if (result.isConfirmed) {
                let form = document.createElement("form");
                form.method = "POST";
                form.action = url;
                document.body.appendChild(form);
                form.submit();
            }
        });
    });
});
</script>

{% endblock %}
